(function(e,i){var a="kcPostFinder",c=false,l=e(i),k=[".kc-find-post"],g,f,b,j,h,d=function(){return k.join(", ")};activate=function(){f=e("#find-posts-input");b=e("#find-posts-response");j=e("#find-posts-submit");h=e("#find-posts-close");j.on("click.kcPostFinder",function(q){q.preventDefault();if(!g.data("kcTarget")){return}var o=b.find("input:checked");if(!o.length){return false}var m=g.data("kcTarget"),p=m.val(),p=p===""?[]:p.split(","),n=o.val();if(m.is(".unique")){m.val(n)}else{if(e.inArray(n,p)<0){p.push(n);m.val(p.join(","))}}});l.on("dblclick.kcPostFinder",'input[name="found_post_id"]',function(){j.trigger("click.kcPostFinder")});l.on("click.kcPostFinder","#find-posts-close",function(){f.val("");g.removeData("kcTarget")});c=true},deactivate=function(){unbind();j.off("click.kcPostFinder");l.off("dblclick.kcPostFinder");l.off("click.kcPostFinder");g=f=b=j=h=null;c=false},action=function(m){g.data("kcTarget",e(this));findPosts.open()},bind=function(){l.on("dblclick.kcPostFinder",d(),action)},unbind=function(){l.off("dblclick.kcPostFinder",d(),action)},publicMethod=e[a]=function(m){var n=this;if(c){if(!m){return}unbind()}else{g=e("#find-posts");if(!g.length){return}activate()}if(m){k=k.concat(m.split(","))}bind();return n};publicMethod.destroy=function(){deactivate()}}(jQuery,document));(function(g,l){var c="kcRowCloner",d=false,n=g(l),i={add:[],del:[]},f=function(){k();d=true},b=function(){o();d=false;i={add:[],del:[]}},e=function(v){var t=g(v.target),s;if(t.is("a.add")){s=p}else{if(t.is("a.del")){s=m}else{return}}v.preventDefault();var q=g(v.currentTarget),u=!q.next(".row").length,r=q.parent();s.call(v,{anchor:t,item:q,mode:q.data("mode"),isLast:u,block:r})},p=function(q){var r=this;a("add",r,q)},m=function(q){var r=this;if(!q.item.siblings(".row").length){q.item=h(q.item);q.item.find(".hasdep").trigger("change");q.removed=false;a("del",r,q,"pret")}else{q.removed=true;q.item.addClass("removing").fadeOut("slow",function(){q.item.remove();if(!q.isLast){q.block=q.block.kcReorder(q.mode,true)}delete q.item;a("del",r,q)})}},h=function(q){g('input[type="checkbox"]',q).prop("checked",false),g('input[type="text"]').val("");return q},a=function(u,t,r,q){for(var s=0;s<i[u].length;s++){i[u][s].call(t,r)}},k=function(){n.on("click.kcRowCloner","li.row",e)},o=function(){n.off("click.kcRowCloner","li.row",e)},j=g[c]=function(){var q=this;if(d){return}f();return q};j.destroy=function(){b()};j.addCallback=function(q,r){if(i.hasOwnProperty(q)&&g.isFunction(r)){i[q].push(r)}}})(jQuery,document);(function(b){var a=b(document);b(".widgets-sortables .hasdep").kcFormDep();b(".widgets-sortables").ajaxSuccess(function(){b(".hasdep",this).kcFormDep()});a.on("click",".kcw-control-block a.add",function(f){f.preventDefault();var d=b(this),c=d.parent().prev(".row");if(c.is(":hidden")){c.slideDown()}else{$nu=c.clone(true).hide();c.after($nu);$nu.slideDown().kcReorder(d.attr("rel"),false).find(".hasdep").kcFormDep()}});b.kcRowCloner();b.kcPostFinder()})(jQuery);